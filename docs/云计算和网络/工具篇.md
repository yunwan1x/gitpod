# [linux kvm虚拟化指南](https://documentation.suse.com/zh-cn/sles/15-SP2/html/SLES-all/book-virt.html)

1. [redhat 虚拟化指南](https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/7/html/virtualization_getting_started_guide/index)
2. [arch 虚拟化指南](https://wiki.archlinux.org/title/libvirt_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87))
3. [libvert指南](https://wiki.libvirt.org/page/Networking)
4. [动态路由架设 Quagga](http://shouce.jb51.net/vbird-linux-server-3/52.html)

# KVM使用

[ubuntu2004安装kvm](https://xie.infoq.cn/article/af423568b655968a605ed7fac)

1. centos7 安装kvm, [参考](https://github.com/jaywcjlove/handbook/blob/master/CentOS/CentOS7%E5%AE%89%E8%A3%85KVM%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%AF%A6%E8%A7%A3.md)，安装完以后如果以root启动的的话，请修改/etc/qemu/conf，放开root用户。然后 systemctl restart libvirtd

```shell
yum -y install qemu-kvm libvirt virt-install bridge-utils libguestfs-tools-c && systemctl enable libvirtd && systemctl start libvirtd
```

## 开启嵌套虚拟化

1. [hyper v开启](https://blog.csdn.net/hbuxiaofei/article/details/117574024)
2. virtualbox 开启

## libvirt 使用

1. 修改适合root用户运行

   Changing /etc/libvirt/qemu.conf to make things work.
   Uncomment user/group to work as root.
   Then restart libvirtd
2. 修改官方镜像的默认[账户密码](https://cdn.leux.cn/doc/Debian%E5%AE%98%E6%96%B9qcow2%E9%95%9C%E5%83%8F%E4%BF%AE%E6%94%B9root%E5%AF%86%E7%A0%81.html)

### virt命令使用

```shell
virt-custom 自定义镜像 http://www.chenshake.com/dib-and-virt-customize-a-custom-mirror-image/
```

## 磁盘转换

```shell
VBoxManage.exe convertdd disk.raw disk.vhd --format VHD
qemu-img 
```

## 修改默认密码

```shell
# OpenStack改qcow2镜像密码
apt install libguestfs-tools
yum install -y libguestfs-tools-c
virt-sysprep --root-password password:einemc@2 -a my-image.qcow2
# 修改方法
virt-customize -a Fedora-Cloud-Base-33-1.2.x86_64.qcow2 --root-password password:root

```

# 代理使用

1. socks代理服务器的使用 , ssh动态代理可以当作socks5。 bash 的https_proxy代理如下代码
2. 使用 [gost](https://github.com/ginuerzh/gost) 代理工具，[brook](https://txthinking.github.io/brook/#/zh-cn/)，类似的有socat ，nc，ssh隧道等，trojan 或者 v2ray
3. websocketd 将一切stdin和stdout转换为websocket管道，[参考](https://www.cnblogs.com/tinywan/p/6826125.html)
4. [ttyd，gotty等webterminal工具](https://tsl0922.github.io/ttyd/)

```bash
# 任意使用一项
export https_proxy=10.0.0.52:8080
export https_proxy=user:pass@192.158.8.8:8080
export https_proxy=socks://10.0.0.52:1080
export https_proxy=socks4://10.0.0.52:1080
export https_proxy=socks5://10.0.0.52:1080

# 验证
curl -v $url
```

# jrebel和xrebel

[参考1](https://www.frankfeekr.cn/2019/07/17/springboot-idea-jrebel-hotswap/index.html)
[参考2](https://juejin.cn/post/6996976545784922119)

# k3s安装

[离线安装](https://docs.rancher.cn/docs/k3s/installation/airgap/_index/)，服务默认安装的是systemd。 可以考虑用[k3d](https://github.com/rancher/k3d)试试多节点单机部署。

```shell
# 下载image的tar包，install.sh，k3s二进制文件
cp k3s /usr/local/bin
sudo mkdir -p /var/lib/rancher/k3s/agent/images/
sudo cp ./k3s-airgap-images-$ARCH.tar /var/lib/rancher/k3s/agent/images/
# 安装server节点
INSTALL_K3S_SKIP_DOWNLOAD=true INSTALL_K3S_SELINUX_WARN=true ./install.sh
# 安装agent节点
INSTALL_K3S_SKIP_DOWNLOAD=true K3S_URL=https://myserver:6443 K3S_TOKEN=mynodetoken ./install.sh

```

## 安装选项

[参考链接](https://docs.rancher.cn/docs/k3s/installation/install-options/_index)，安装的默认配置文件可以写在这里`/etc/rancher/k3s/config.yaml`

# [vagrant使用](https://www.vagrantup.com/docs/vagrantfile)

1. 镜像站有这些，[centos](https://cloud.centos.org/centos/)，[vagrantbox](http://www.vagrantbox.es/)，[ubuntu](http://cloud-images.ubuntu.com/) 以及官方仓库。
2. vagrant设置虚拟机文件存放目录，VAGRANT_HOME=~/.vagrant.d
3. 需要设置虚拟机默认创建的目录

## 参考

* http://blog.timd.cn/vagrant/
* [vagrant资源列表](https://vagrant-lists.github.io/)
* vagrant virtualbox 使用链接clone的方式[使用](https://www.junmajinlong.com/virtual/vagrant/vagrant_linked_clone/)

# [开源网络软件](https://www.githubs.cn/collections/proxy)

1. [mitmproxy](https://github.com/mitmproxy/mitmproxy)

   * mitmproxy，中间人攻击工具使用方法：[usage](https://blog.wolfogre.com/posts/usage-of-mitmproxy/)
   * [mitm 类似的软件](https://zh.altapps.net/soft/mitmproxy)
